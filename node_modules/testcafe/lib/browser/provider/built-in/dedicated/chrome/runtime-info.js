"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const endpoint_utils_1 = require("endpoint-utils");
const config_1 = __importDefault(require("./config"));
const create_temp_profile_1 = __importDefault(require("./create-temp-profile"));
const is_docker_1 = __importDefault(require("is-docker"));
async function default_1(proxyHostName, configString, allowMultipleWindows) {
    const config = config_1.default(configString);
    const tempProfileDir = !config.userProfile ? await create_temp_profile_1.default(proxyHostName, allowMultipleWindows) : null;
    const cdpPort = config.cdpPort || (!config.userProfile ? await endpoint_utils_1.getFreePort() : null);
    const inDocker = is_docker_1.default();
    return {
        config,
        cdpPort,
        tempProfileDir,
        inDocker
    };
}
exports.default = default_1;
module.exports = exports.default;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicnVudGltZS1pbmZvLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vc3JjL2Jyb3dzZXIvcHJvdmlkZXIvYnVpbHQtaW4vZGVkaWNhdGVkL2Nocm9tZS9ydW50aW1lLWluZm8udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxtREFBNkM7QUFDN0Msc0RBQWlDO0FBQ2pDLGdGQUFzRDtBQUN0RCwwREFBaUM7QUFjbEIsS0FBSyxvQkFBVyxhQUFxQixFQUFFLFlBQW9CLEVBQUUsb0JBQTZCO0lBQ3JHLE1BQU0sTUFBTSxHQUFXLGdCQUFTLENBQUMsWUFBWSxDQUFDLENBQUM7SUFDL0MsTUFBTSxjQUFjLEdBQUcsQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxNQUFNLDZCQUFpQixDQUFDLGFBQWEsRUFBRSxvQkFBb0IsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUM7SUFDakgsTUFBTSxPQUFPLEdBQVUsTUFBTSxDQUFDLE9BQU8sSUFBSSxDQUFDLENBQUMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsTUFBTSw0QkFBVyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQzVGLE1BQU0sUUFBUSxHQUFTLG1CQUFRLEVBQUUsQ0FBQztJQUVsQyxPQUFPO1FBQ0gsTUFBTTtRQUNOLE9BQU87UUFDUCxjQUFjO1FBQ2QsUUFBUTtLQUNYLENBQUM7QUFDTixDQUFDO0FBWkQsNEJBWUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBnZXRGcmVlUG9ydCB9IGZyb20gJ2VuZHBvaW50LXV0aWxzJztcbmltcG9ydCBnZXRDb25maWcgZnJvbSAnLi9jb25maWcnO1xuaW1wb3J0IGNyZWF0ZVRlbXBQcm9maWxlIGZyb20gJy4vY3JlYXRlLXRlbXAtcHJvZmlsZSc7XG5pbXBvcnQgaXNEb2NrZXIgZnJvbSAnaXMtZG9ja2VyJztcbmltcG9ydCBUZW1wRGlyZWN0b3J5IGZyb20gJy4uLy4uLy4uLy4uLy4uL3V0aWxzL3RlbXAtZGlyZWN0b3J5JztcbmltcG9ydCB7IERpY3Rpb25hcnkgfSBmcm9tICcuLi8uLi8uLi8uLi8uLi9jb25maWd1cmF0aW9uL2ludGVyZmFjZXMnO1xuXG5pbnRlcmZhY2UgQ2hyb21lUnVudGltZUluZm8ge1xuICAgIGNvbmZpZzogYW55O1xuICAgIHRlbXBQcm9maWxlRGlyOiBudWxsIHwgVGVtcERpcmVjdG9yeTtcbiAgICBjZHBQb3J0OiBudWxsIHwgbnVtYmVyO1xuICAgIGluRG9ja2VyOiBib29sZWFuO1xuICAgIGJyb3dzZXJOYW1lPzogc3RyaW5nO1xuICAgIGJyb3dzZXJJZD86IHN0cmluZztcbiAgICBwcm92aWRlck1ldGhvZHM/OiBEaWN0aW9uYXJ5PEZ1bmN0aW9uPjtcbn1cblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gKHByb3h5SG9zdE5hbWU6IHN0cmluZywgY29uZmlnU3RyaW5nOiBzdHJpbmcsIGFsbG93TXVsdGlwbGVXaW5kb3dzOiBib29sZWFuKTogUHJvbWlzZTxDaHJvbWVSdW50aW1lSW5mbz4ge1xuICAgIGNvbnN0IGNvbmZpZyAgICAgICAgID0gZ2V0Q29uZmlnKGNvbmZpZ1N0cmluZyk7XG4gICAgY29uc3QgdGVtcFByb2ZpbGVEaXIgPSAhY29uZmlnLnVzZXJQcm9maWxlID8gYXdhaXQgY3JlYXRlVGVtcFByb2ZpbGUocHJveHlIb3N0TmFtZSwgYWxsb3dNdWx0aXBsZVdpbmRvd3MpIDogbnVsbDtcbiAgICBjb25zdCBjZHBQb3J0ICAgICAgICA9IGNvbmZpZy5jZHBQb3J0IHx8ICghY29uZmlnLnVzZXJQcm9maWxlID8gYXdhaXQgZ2V0RnJlZVBvcnQoKSA6IG51bGwpO1xuICAgIGNvbnN0IGluRG9ja2VyICAgICAgID0gaXNEb2NrZXIoKTtcblxuICAgIHJldHVybiB7XG4gICAgICAgIGNvbmZpZyxcbiAgICAgICAgY2RwUG9ydCxcbiAgICAgICAgdGVtcFByb2ZpbGVEaXIsXG4gICAgICAgIGluRG9ja2VyXG4gICAgfTtcbn1cbiJdfQ==