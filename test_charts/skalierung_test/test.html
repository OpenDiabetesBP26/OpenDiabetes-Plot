<html>
<head>
<script src="https://d3js.org/d3.v5.min.js"></script>

</head>
<body>
<button onclick="update(200);">Click</button>
<input type="range" min="100" max="400" value="400" class="slider" id="testSlider">
<input type="range" min="1" max="23" value="400" class="slider" id="testSlider2">
<svg id="food-chart" width="500" height="500"></svg>
<script>
//Food Chart
  //Test Data
  const dataFood = [
    {date: new Date(2019, 11, 5, 8, 0), value: 56},
    {date: new Date(2019, 11, 5, 8, 30), value: 12},
    {date: new Date(2019, 11, 5, 9, 30), value: 12},
    {date: new Date(2019, 11, 5, 10, 0), value: 6},
    {date: new Date(2019, 11, 5, 12, 0), value: 152},
    {date: new Date(2019, 11, 5, 13, 0), value: 12},
    {date: new Date(2019, 11, 5, 14, 0), value: 32},
    {date: new Date(2019, 11, 5, 16, 0), value: 12},
    {date: new Date(2019, 11, 5, 19, 30), value: 132},
    {date: new Date(2019, 11, 5, 21, 0), value: 12},
  ]
  //Creating Selection
  const foodChart = d3.select('svg#food-chart');
  //Creating vars for graph size
  const widthChart = +foodChart.attr('width');
  const heightChart = +foodChart.attr('height');
  const margin = {top: 50, right: 40, bottom: 30, left: 40};
  const innerWidth = widthChart - margin.right - margin.left;
  const innerHeight = heightChart - margin.top - margin.bottom;
  const widthRect = 20
  //Creating Scales
  //Y Scale --> food consumed
  const yScaleFood = d3.scaleLinear().domain([d3.max(dataFood, d => d.value),0]).range([0,innerHeight])
  const xScaleFood = d3.scaleTime().domain(d3.extent(dataFood, (d) => d.date)).range([0,innerWidth])
  const groupFood = foodChart.append('g')
                                .attr('transform', 'translate('+margin.left+','+margin.top + ')'); //Move to offset
  const rects = groupFood.selectAll('rect').data(dataFood).join(
    (enter) => enter.append('rect')
                  .attr('height', d => innerHeight-yScaleFood(d.value))
                  .attr('x', d => xScaleFood(d.date))
                  .attr('y', d=>yScaleFood(d.value))
                  .attr('width', widthRect),
	(update) => update.attr('height', d => innerHeight-yScaleFood(d.value))
	.attr('x', d => xScaleFood(d.date))
	.attr('y', d=>yScaleFood(d.value))
	.attr('width', widthRect)

  );
  //Add Axes
  const xAxisFood = d3.axisBottom().scale(xScaleFood)
  const xAxisFoodG = foodChart.append('g')
                        .attr('class', 'xAxis')
                        .attr('transform', 'translate('+margin.left+','+(heightChart-margin.bottom)+')')
                        .call(xAxisFood)
  const yAxisFood = d3.axisLeft().scale(yScaleFood)
  const yAxisFoodG = foodChart.append('g')
                        .attr('class', 'yAxis')
                        .attr('transform', 'translate('+margin.left+', '+margin.top+')')
                        .call(yAxisFood)
  const slider = d3.select("#testSlider").on("input",function(){update(+this.value);});
  const slider2 = d3.select("#testSlider2").on("input",function(){update_two(+this.value);});
  function update(value){
	yScaleFood.domain([value, 0])
	yAxisFoodG.transition().duration(1500).call(yAxisFood)
	groupFood.selectAll('rect').data(dataFood).join(
	(enter) => enter,
	(update) => update.transition().duration(1500).attr('height', d => innerHeight-yScaleFood(d.value))
	.attr('x', d => xScaleFood(d.date))
	.attr('y', d=>yScaleFood(d.value))
	.attr('width', widthRect)

  );
  }
  function update_two(value){
	xScaleFood.domain([new Date(2019, 11 ,5, 0, 0), new Date(2019, 11, 5, value,0)])
	xAxisFoodG.transition().duration(1500).call(xAxisFood)
	groupFood.selectAll('rect').data(dataFood).join(
	(enter) => enter,
	(update) => update.transition().duration(1500).attr('height', d => innerHeight-yScaleFood(d.value))
	.attr('height', d => innerHeight-yScaleFood(d.value))
     .attr('x', d => xScaleFood(d.date))
      .attr('y', d=>yScaleFood(d.value))
                  .attr('width', widthRect),)
  }
</script>
</body>
</html>